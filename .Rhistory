knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(caTools)
library(xgboost)
library(caret)
library(ROCR)
library(pROC)
library(ROSE)
library(randomForest)
library(ggplot2)
library(dplyr)
library(solitude)
credit_card_raw = fread("~/Desktop/810supervised/team project/creditcard.csv")
credit_card_raw[, test:=0]
credit_card_raw[, "Time":= NULL]
credit_card_raw[sample(nrow(credit_card_raw), 284807*0.2), test:=1]
test <- credit_card_raw[test==1]
train <- credit_card_raw[test==0]
train[, "test" := NULL]
test[, "test" := NULL]
credit_card_raw[, "test" := NULL]
setDF(train)
setDF(test)
set.seed(1)
train$Class <- factor(train$Class)
downsample.train <- downSample(train[, -ncol(train)], train$Class)
test$Class <- factor(test$Class)
downsample.test <- downSample(test[, -ncol(test)], test$Class)
set.seed(1)
down_fit <- glm(Class ~ .,family = "binomial" ,data = downsample.train)
summary(down_fit,)
pred_down <- predict(down_fit, newdata = test)
print('Fitting downsampled model to test data')
roc.curve(test$Class, pred_down, plotit=TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(caTools)
library(xgboost)
library(caret)
library(ROCR)
library("pROC")
library(PRROC)
credit_card_raw = fread("~/Desktop/810supervised/team project/creditcard.csv")
credit_card_raw[, test:=0]
credit_card_raw[, "Time":= NULL]
credit_card_raw[sample(nrow(credit_card_raw), 284807*0.2), test:=1]
test <- credit_card_raw[test==1]
train <- credit_card_raw[test==0]
train[, "test" := NULL]
test[, "test" := NULL]
credit_card_raw[, "test" := NULL]
setDF(train)
setDF(test)
set.seed(1)
train$Class <- factor(train$Class)
downsample.train <- downSample(train[, -ncol(train)], train$Class)
test$Class <- factor(test$Class)
downsample.test <- downSample(test[, -ncol(test)], test$Class)
set.seed(1)
down_fit <- glm(Class ~ .,family = "binomial" ,data = downsample.train)
summary(down_fit,)
pred_down <- predict(down_fit, downsample.test)
print('Fitting downsampled model to test data')
roc.curve(test$Class, pred_down, plotit=TRUE)
set.seed(1)
down_fit <- glm(Class ~ .,family = "binomial" ,data = downsample.train)
summary(down_fit,)
pred_down <- predict(down_fit, test)
print('Fitting downsampled model to test data')
roc.curve(test$Class, pred_down, plotit=TRUE)
roc.curve(downsample.test$Class, pred_down, plotit=TRUE)
set.seed(1)
down_fit <- glm(Class ~ .,family = "binomial" ,data = downsample.train)
summary(down_fit,)
pred_down <- predict(down_fit, newdata = test)
print('Fitting downsampled model to test data')
#Evaluate model performance on test set
roc.curve(test$Class, pred_down, plotit=TRUE)
set.seed(1)
down_fit <- glm(Class ~ .,family = "binomial" ,data = downsample.train)
summary(down_fit,)
pred_down <- predict(down_fit, newdata = test)
print('Fitting downsampled model to test data')
#Evaluate model performance on test set
roc.curve(test$Class, pred_down, plotit=TRUE)
## Splitting Data
```{r}
# Create train and test dataset
credit_card_raw[, test:=0]
credit_card_raw[, "Time":= NULL]
credit_card_raw[sample(nrow(credit_card_raw), 284807*0.2), test:=1]
test <- credit_card_raw[test==1]
train <- credit_card_raw[test==0]
train[, "test" := NULL]
test[, "test" := NULL]
credit_card_raw[, "test" := NULL]
# Convert datatables to dataframes for downsampling
setDF(train)
setDF(test)
# Downsample
set.seed(1)
train$Class <- factor(train$Class)
downsample.train <- downSample(train[, -ncol(train)], train$Class)
test$Class <- factor(test$Class)
downsample.test <- downSample(test[, -ncol(test)], test$Class)
set.seed(1)
down_fit <- glm(Class ~ .,family = "binomial" ,data = downsample.train)
summary(down_fit,)
pred_down <- predict(down_fit, newdata = test)
print('Fitting downsampled model to test data')
#Evaluate model performance on test set
roc.curve(test$Class, pred_down, plotit=TRUE)
